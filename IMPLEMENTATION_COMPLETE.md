# 🎮 스탯 기반 선택지 시스템 - 완성! ✅

## ✨ 완료된 작업

### 1. types.ts ✅
- `SuggestedAction` 인터페이스 추가
- `required_stats`, `stat_changes`, `is_trap`, `trap_ending` 필드 정의
- `GameState`에 `suggested_actions?` 추가

### 2. ActionChoices.tsx ✅
- 3개 선택지 리스트 UI 컴포넌트 생성
- 스탯 충족 여부 실시간 체크
- 스탯 부족 시 비활성화
- 스탯 변화량 표시
- A, B, C 키보드 단축키 지원

### 3. App.tsx ✅
- `handleActionChoice()` 함수 추가:
  - 트랩 체크 → 즉시 배드엔딩
  - 스탯 요구사항 체크 → 부족 시 실패 엔딩
  - 스탯 변화 적용
  - 스탯 0 이하 체크 → 고갈 엔딩
  - 정상 진행 → AI에게 다음 스토리 요청
- `getStatDepletionEnding()` 함수 추가
- GameScreen에 `handleActionChoice` prop 전달

### 4. constants.ts ✅
- `HORROR_PROMPT` 수정 (스탯 정의 + suggested_actions 지시)
- `THRILLER_PROMPT` 수정
- `ROMANCE_PROMPT` 수정
- `GAME_PROGRESS_PROMPT` 수정 (상세한 선택지 생성 규칙)

---

## 🎮 게임 흐름

```
1. 시나리오 선택
   ↓
2. AI가 초기 스토리 + 3개 선택지 생성
   stats: {
     "정신력": 100,
     "체력": 100,
     "공포도": 20
   }
   suggested_actions: [A, B, C]
   ↓
3. 선택지 표시
   [A] 🚪 조심스럽게 문을 연다 (정신력 -5) ✅
   [B] 👂 문에 귀를 댄다 (정신력 -3) ✅
   [C] 🔦 불을 켠다 (정신력 80+ 필요) ❌ 스탯 부족!
   ↓
4. 플레이어 선택
   ↓
5-1. 트랩 선택 → 즉시 배드엔딩
5-2. 스탯 부족 → 실패 엔딩
5-3. 안전 선택 → 스탯 변화 적용
   ↓
6. 스탯 0 이하 체크
   정신력 <= 0 → "정신력 고갈" 엔딩
   체력 <= 0 → "체력 고갈" 엔딩
   공포도 >= 100 → "공포도 100" 엔딩
   ↓
7. 계속 진행 → 다음 스토리
```

---

## 🎯 시나리오별 스탯

### Horror (공포)
```json
{
  "정신력": 100,  // 0 → 광기 엔딩
  "체력": 100,    // 0 → 탈진 엔딩
  "공포도": 20    // 100 → 심장마비 엔딩
}
```

### Thriller (스릴러)
```json
{
  "정신력": 100,  // 0 → 패닉 엔딩
  "체력": 100,    // 0 → 부상 엔딩
  "긴장도": 30    // 100 → 실수 엔딩
}
```

### Romance (로맨스)
```json
{
  "용기": 70,      // 0 → 포기 엔딩
  "호감도": 50,    // 0 → 거절 엔딩
  "자신감": 80     // 0 → 좌절 엔딩
}
```

---

## 🧪 테스트 방법

### 1. 프로젝트 실행
```bash
npm run dev
```

### 2. 테스트 체크리스트
- [ ] Horror 시나리오 시작
- [ ] 3개 선택지가 표시되는가?
- [ ] A, B, C 버튼 클릭 가능?
- [ ] A, B, C 키보드로 선택 가능?
- [ ] 스탯 부족 선택지는 비활성화?
- [ ] 선택 후 스탯 변화 적용?
- [ ] 트랩 선택 시 즉시 엔딩?
- [ ] 스탯 0 이하 시 게임 오버?
- [ ] Thriller 시나리오 테스트
- [ ] Romance 시나리오 테스트

---

## 🎨 UI 예시

### 정상 상태
```
┌─────────────────────────────────────┐
│ 📊 현재 상태                         │
│ 정신력: 85 [████████░░] 85%        │
│ 체력:   90 [█████████░] 90%        │
│ 공포도: 35 [████░░░░░░] 35%        │
└─────────────────────────────────────┘

┌─────────────────────────────────────┐
│ 💡 어떻게 하시겠습니까?              │
│                                      │
│ [A] 🚪 조심스럽게 문을 열어본다     │
│     정신력 -5, 공포도 +5            │
│                                      │
│ [B] 👂 문에 귀를 대고 들어본다      │
│     정신력 -3                       │
│                                      │
│ [C] 🔦 불을 켜고 큰소리로 외친다   │
│     정신력 -20, 체력 -10            │
└─────────────────────────────────────┘
```

### 위험 상태
```
┌─────────────────────────────────────┐
│ 📊 현재 상태                         │
│ 정신력: 15 [██░░░░░░░░] 15% ⚠️     │
│ 체력:   20 [██░░░░░░░░] 20% ⚠️     │
│ 공포도: 90 [█████████░] 90% 🚨     │
│                                      │
│ 🚨 위험! 스탯 0이면 게임 오버!       │
└─────────────────────────────────────┘

┌─────────────────────────────────────┐
│ [A] 🚪 문 열기 (정신력 -5) ✅       │
│ [B] 👂 듣기 (정신력 -3) ✅         │
│ [C] 🔦 불 켜기 (정신력 50+ 필요)   │
│     ⚠️ 정신력 50+ 필요 ❌           │
└─────────────────────────────────────┘
```

---

## 📋 엔딩 종류

### 1. 트랩 엔딩 (즉시)
```
"섣부른 행동의 대가"
불빛에 끌린 그것이 당신을 덮쳤습니다...
```

### 2. 스탯 부족 엔딩
```
"능력 부족"
정신력: 45/70
체력: 60/80
```

### 3. 스탯 고갈 엔딩
```
Horror:
- 정신력 0: "당신의 정신은 공포에 완전히..."
- 체력 0: "더 이상 버틸 수 없습니다..."
- 공포도 100: "극도의 공포에 심장이..."

Thriller:
- 정신력 0: "극한의 압박감에 정신이..."
- 체력 0: "부상과 피로가 한계에..."
- 긴장도 100: "과도한 긴장으로 판단력을..."

Romance:
- 용기 0: "용기를 완전히 잃어버렸습니다..."
- 호감도 0: "상대의 호감도가 바닥에..."
- 자신감 0: "자신감을 완전히 상실했습니다..."
```

### 4. 타임아웃 엔딩
```
60초 시간 초과 시 각 시나리오별 특별 엔딩
```

---

## 🎉 완성!

**모든 파일이 수정되었습니다!**

### 수정된 파일 목록:
1. ✅ `C:\Temp\data\types.ts`
2. ✅ `C:\Temp\data\components\ActionChoices.tsx` (신규 생성)
3. ✅ `C:\Temp\data\App.tsx`
4. ✅ `C:\Temp\data\constants.ts`

### 기존 파일 (수정 불필요):
- `C:\Temp\data\components\ActionChoice.tsx` (이미 존재)
- `C:\Temp\data\components\GameScreen.tsx` (이미 onActionChoice 지원)

---

## 🚀 바로 테스트 가능!

```bash
cd C:\Temp\data
npm run dev
```

---

## 💡 추가 개선 가능 사항

### 1. 스탯 애니메이션
- 스탯 변화 시 숫자 카운트업
- 프로그레스 바 부드러운 전환

### 2. 사운드 효과
- 트랩 선택 시 특별 효과음
- 스탯 고갈 경고음

### 3. 난이도 조절
- 스탯 변화량 조절
- 트랩 비율 조절

---

테스트해보시고 문제 있으면 말씀해주세요! 🎮✨
